<script>
  const routes = {
    '/': `
      <div class="bg-banner">
        <h1 class="display-4">Explore AI Image Prompts</h1>
      </div>
      <div class="container my-5">
        <div class="row text-center">
          ${[
            { img: "lion", title: "Animals" },
            { img: "football", title: "Sports" },
            { img: "landscape", title: "Nature" },
            { img: "robot", title: "Technology" },
            { img: "fantasy", title: "Fantasy" }
          ].map(cat => `
            <div class="col-md-4 mb-4">
              <div class="card">
                <img src="https://source.unsplash.com/400x200/?${cat.img}" class="card-img-top" alt="${cat.title}">
                <div class="card-body">
                  <h5 class="card-title">${cat.title}</h5>
                </div>
              </div>
            </div>
          `).join('')}
        </div>
      </div>
    `,
    '/about': () => {
      const email = window.userData?.email || "Not logged in";
      return `
        <div class="container my-5">
          <h2>About This Website</h2>
          <p>This site showcases categorized AI image generation prompts to inspire creativity and save time. Whether you're working on animals, sports, or tech, we have prompts to help you bring ideas to life.</p>
          <hr />
          <h5>ðŸ‘¤ Logged in as: <span class="text-primary">${email}</span></h5>
        </div>
      `;
    },
    '/contact': `
      <div class="container my-5">
        <h2>Contact Us</h2>
        <form>
          <div class="mb-3">
            <label for="name" class="form-label">Your Name</label>
            <input type="text" class="form-control" id="name">
          </div>
          <div class="mb-3">
            <label for="email" class="form-label">Email address</label>
            <input type="email" class="form-control" id="email">
          </div>
          <div class="mb-3">
            <label for="message" class="form-label">Message</label>
            <textarea class="form-control" id="message" rows="3"></textarea>
          </div>
          <button type="submit" class="btn btn-primary">Submit</button>
        </form>
      </div>
    `
  };

  function renderRoute() {
    const path = window.location.hash.slice(1) || '/';
    document.querySelectorAll('.nav-link').forEach(link => {
      link.classList.remove('active');
      if (link.getAttribute('href') === `#${path}`) {
        link.classList.add('active');
      }
    });
    const content = typeof routes[path] === 'function' ? routes[path]() : routes[path];
    document.getElementById('app').innerHTML = content || '<div class="container my-5"><h2>Page Not Found</h2></div>';
  }

  // Toggle light/dark mode
  document.getElementById('toggleMode').addEventListener('click', () => {
    const body = document.body;
    body.classList.toggle('light-mode');
    body.classList.toggle('dark-mode');
  });

  function handleCredentialResponse(response) {
    const data = jwt_decode(response.credential);
    console.log("User Data:", data);
    window.userData = data;
    localStorage.setItem("userData", JSON.stringify(data));

    document.getElementById('login-section').style.display = 'none';
    document.getElementById('main-nav').classList.remove('d-none');
    document.getElementById('app').style.display = 'block';

    window.location.hash = "#/"; // Go to home
    renderRoute();
  }

  window.addEventListener('hashchange', renderRoute);

  window.addEventListener('load', () => {
    const savedUser = localStorage.getItem("userData");
    if (savedUser) {
      window.userData = JSON.parse(savedUser);
      document.getElementById('login-section').style.display = 'none';
      document.getElementById('main-nav').classList.remove('d-none');
      document.getElementById('app').style.display = 'block';

      if (!window.location.hash || window.location.hash === "#") {
        window.location.hash = "#/";
      }

      renderRoute();
    } else {
      // still on login screen
    }
  });
</script>
